jQuery(document).ready(function(s){"use strict";var d=s(".urcma-endpoints-options-wrapper");function c(e){var t=tinyMCEPreInit.mceInit,n=Object.keys(t)[0],a=t[n],i=tinyMCEPreInit.qtInit,i=t[Object.keys(i)[0]];a.selector=e,a.body_class=a.body_class.replace(n,e),i.id=e,tinyMCE.init(a),tinyMCE.execCommand("mceRemoveEditor",!0,e),tinyMCE.execCommand("mceAddEditor",!0,e),quicktags(i),QTags._buttonsInit()}"undefined"!=typeof s.fn.sortable&&s(".urcma-endpoint-tabs").sortable({containment:".urcma-endpoint-tabs",tolerance:"pointer",revert:"invalid",forceHelperSize:!0}),s("form#mainform").on("submit",function(e){var n,t;"undefined"!=typeof s.fn.sortable&&(n=[],s(".urcma-endpoint-selector").each(function(e){var t={type:s(this).data("type"),id:s(this).attr("id")};n.push(t)}),t=JSON.stringify(n),s("input.endpoints-order").val(t))}),d.on("change",function(e,t){void 0!==t&&c(t.find("textarea").attr("id"))}),s(document).on("click",".add_new_field",function(e){e.stopPropagation();var n='<i class="dashicons dashicons-plus-alt"></i>',e=urcma_params.add_new_tab_title.replace("%str%"," ");Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:n+'<span class="user-registration-swal2-modal__title">'+e+"</span>",text:urcma_params.select_field_type_description,input:"select",inputOptions:{endpoint:"Endpoint",link:"Link"},inputPlaceholder:urcma_params.select_field_type_placeholder,showCloseButton:!1,showCancelButton:!0,cancelButtonColor:"#DD6B55",allowOutsideClick:!1,inputValidator:e=>{if(!e)return urcma_params.select_field_validation_message}}).then(function(e){var t;e.value&&(t=e.value,e=urcma_params.add_new_tab_title.replace("%str%",t),Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:n+'<span class="user-registration-swal2-modal__title">'+e+"</span>",text:urcma_params.field_title_description.replace("%str%",t),input:"text",inputAttributes:{autocapitalize:"off"},inputValidator:e=>{if(!e)return urcma_params.field_title_validation_message.replace("%str%",t)},showCloseButton:!1,showCancelButton:!0,cancelButtonColor:"#DD6B55",allowOutsideClick:!1}).then(function(e){e.value&&(e=e.value,s(this).add_new_field_handler(t,e))}))})}),s.fn.add_new_field_handler=function(i,r){var o=s(this);s.ajax({url:urcma_params.ajaxurl,data:{target:i,field_name:r,action:urcma_params.action_add},dataType:"json",beforeSend:function(){},success:function(e){var t,n,a;o.find(".loader").hide(),e.error||d.find('[data-id="'+e.field+'"]').length?swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:"Oops...",text:e.error}):(swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"success",html:r.toUpperCase()+" "+urcma_params.add_endpoint_success_message.replace("%str%",i)}).then(function(e){s(".button-primary").trigger("click")}),t=s(e.html),n=s(".urcma-endpoints-options-wrapper"),s(".urcma-endpoint-tabs > .urcma-endpoint-selector").removeClass("active"),n.find(".urcma-endpoint-content").attr("style","display:none;"),a='<div class="ur-sidebar-nav-tab urcma-endpoint-selector ui-sortable-handle active" id="'+e.field+'" data-id="'+e.endpoint_label+'" data-type="'+e.type+'">\n'+e.endpoint_label+"</div>",s(".urcma-endpoint-tabs > .urcma-endpoint-selector").last().after(a),s(".urcma-endpoints-options-wrapper .urcma-endpoint-content").last().after(t),e=e.field,n.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),n.find("#"+e).find(".urcma-endpoint-header").removeAttr("style"),n.find("#"+e).find(".urcma-endpoint-options").removeAttr("style"),l(t.find("select")),c(t.find("textarea").attr("id")))}})},s(document).on("click",".remove-trigger",function(){var n=s(this).data("endpoint"),a=s("input.endpoint-to-remove");if(void 0===n||!a.length)return!1;Swal.fire({icon:"warning",customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",text:urcma_params.remove_alert,showCloseButton:!0,confirmButtonText:"OK"}).then(function(e){if(1!=e.value)return!1;var t=a.val(),e=t.length?t.split(","):[];e.push(n),a.val(e.join(",")),s("#"+n).remove(),s(".urcma-endpoints-wrapper").find("#"+n).remove();t=s(".urcma-endpoints-options-wrapper"),e=s(".urcma-endpoint-selector:first");e.addClass("active");e=e.attr("id");t.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),t.find("#"+e).removeAttr("style"),t.find("#"+e).find(".urcma-endpoint-header").removeAttr("style"),t.find("#"+e).find(".urcma-endpoint-options").removeAttr("style")})}),s(document).ready(function(){var t=s(".urcma-endpoints-options-wrapper"),e=s(".urcma-endpoints-list nav"),n=s(".urcma-endpoint-selector:first");n.addClass("active");n=n.attr("id");t.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),t.find("#"+n).find(".urcma-endpoint-header").removeAttr("style"),t.find("#"+n).find(".urcma-endpoint-options").removeAttr("style"),e.find(".urcma-endpoint-selector").on("click",function(){var e=s(this).attr("id");s(this).siblings().removeClass("active"),s(this).addClass("active"),t.find(".urcma-endpoint-content").attr("style","display:none;"),t.find("#"+e).removeAttr("style"),t.find(".urcma-endpoint-content .urcma-endpoint-header").removeAttr("style"),t.find("#"+e).find(".urcma-endpoint-options").removeAttr("style")})});function a(e){return s('<span><i class="fa fa-'+e.text+'"></i>   '+e.text+"</span>")}function l(e,t){var n;"undefined"!=typeof s.fn.select2&&s.each(e,function(){n=s(this).hasClass("icon-select")?{templateResult:a,templateSelection:a,width:"100%"}:t?{width:"100%"}:{minimumResultsForSearch:10},s(this).select2(n)})}s(document).on("change",".hide-show-check",function(){var e,t,n;e="checkbox",t=s(this),n=t.closest(".urcma-endpoint-content").find(".hide-show-check"),t="checkbox"==e?t:n.first(),!0==(e=!!(t.is(":checked")&&"checkbox"==e||!t.is(":checked")&&"link"==e))?(n.prop("checked",e),n.closest(".urcma-endpoint-header-option").find(".user-registration-switch__control").addClass("enabled"),n.closest(".urcma-endpoint-header-option").find("label").html(urcma_params.enable_endpoint)):(n.removeAttr("checked",e),n.closest(".urcma-endpoint-header-option").find(".user-registration-switch__control").removeClass("enabled"),n.closest(".urcma-endpoint-header-option").find("label").html(urcma_params.disable_endpoint))}),s(document).on("change keyup",".urcma_slug_input",function(){var n=s(this);s(".urcma-endpoint-options").find(".urcma_slug_input").each(function(e,t){t=s(t);t.is(n)||s.trim(t.val())===s.trim(n.val())&&(swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:"Oops...",text:urcma_params.same_slug_error_message}),s(".swal2-confirm").on("click",function(){s(".submit").find(".button-primary").attr("disabled","disabled")}))}),s(".submit").find(".button-primary").removeAttr("disabled")}),s(document).on("change keyup",".urcma_label_input",function(){var n=s(this);s(".urcma-endpoint-options").find(".urcma_label_input").each(function(e,t){t=s(t);t.is(n)||s.trim(t.val())===s.trim(n.val())&&(swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:"Oops...",text:urcma_params.same_label_error_message}),s(".swal2-confirm").on("click",function(){s(".submit").find(".button-primary").attr("disabled","disabled")}))}),s(".submit").find(".button-primary").removeAttr("disabled")}),l(d.find("select"),!0)});